---
layout: post
title: "统计关系学习(Statistical relational learning)"
date: 2025-07-16
categories: [数学，逻辑学]
tags: [综述笔记]
published: true
mermaid: true
math: true
---

## 概率逻辑编程

统计关系学习（Statistical Relational Learning, SRL）是人工智能与机器学习的一个子领域，专注于既具备不确定性（可通过统计方法处理），又具有复杂关系结构的领域模型。通常，SRL 中开发的知识表示形式会使用一阶逻辑（的一部分）来以通用方式（普遍量化）描述领域中的关系特性，同时运用概率图模型（如贝叶斯网络或马尔可夫网络）来处理不确定性；有些方法还借鉴了归纳逻辑编程的技术。自 20 世纪 90 年代末以来，该领域取得了显著发展。


> **一阶逻辑(First-order logic)**  
> **一阶逻辑**，也称为谓词逻辑、谓词演算或量化逻辑，一阶逻辑使用非逻辑对象的量化变量，并允许使用包含变量的句子。  
> “一阶”一词区分了一阶逻辑与高阶逻辑，在高阶逻辑中，存在以谓词或函数为参数的谓词，或者允许对谓词、函数或两者进行量化。在一阶理论中，谓词通常与集合相关联。在解释的高阶理论中，谓词可能被解释为集合的集合。  
> 一阶逻辑是数学公理化形式化的标准，并在数学基础中得到研究。皮亚诺算术和策梅洛–弗兰克尔集合论分别是数论和集合论在一阶逻辑中的公理化。然而，没有任何一阶理论具有足够的力量来唯一描述具有无限域的结构，例如自然数或实数线。要完全描述这两种结构，即分类公理系统，可以在更强的逻辑中，如二阶逻辑中，获得这样的公理系统。  
> **进一步的，下面给出一阶逻辑及其组分的示例**  
> - 考虑两个句子“苏格拉底是一位哲学家”和“柏拉图是一位哲学家”。在命题逻辑中，这些句子本身被视为研究的个体，例如可以用变量 p 和 q 来表示。它们不被视为对论域中任何特定对象的谓词应用，而是被视为纯粹是陈述句，要么为真要么为假。然而，在一阶逻辑中，这两个句子可以被表述为某个特定个体或非逻辑对象具有某种属性的陈述。在这个例子中，两个句子碰巧具有对某个个体$\text{isPhil}(x)$ 。在第一个句子中，变量 x 的值为“苏格拉底”，在第二个句子中为“柏拉图”。由于能够谈论非逻辑个体以及原始的逻辑连接词，一阶逻辑包含了命题逻辑。  
> - 一个公式如“x 是一个哲学家”的真值取决于 x 所表示的对象以及谓词“是一个哲学家”的解释。因此，“x 是一个哲学家”本身没有确定的真或假值，类似于一个句子片段。 [8] 谓词之间的关系可以使用逻辑连接词来陈述。例如，一阶公式“如果 x 是一个哲学家，那么 x 是一个学者”是一个条件语句，其假设为“x 是一个哲学家”，结论为“x 是一个学者”，这同样需要指定 x 才能具有确定的真值。  
> - 量词可以应用于公式中的变量。前一个公式中的变量 x 可以被全称量化，例如，用一阶句子“对于每一个 x，如果 x 是一个哲学家，那么 x 是一个学者”。这个句子中的全称量词“对于每一个”表达了“如果 x 是一个哲学家，那么 x 是一个学者”这一主张对所有 x 的选择都成立的思想。  
> - 句子"对于每一个 x，如果 x 是哲学家，那么 x 是学者"的否定在逻辑上等价于句子"存在某个 x，使得 x 是哲学家且 x 不是学者"。存在量词"存在"表达了"x 是哲学家且 x 不是学者"这一命题对于某些 x 的选择成立的思想。  
> - 谓词"是哲学家"和"是学者"各自取一个变量。通常，谓词可以取多个变量。在一阶句子"Socrates 是 Plato 的老师"中，谓词"是...的老师"取两个变量。
{: .prompt-info }

**统计关系学习的典型任务包括**：

- 集体分类，即根据对象的属性及其关系（同时）预测多个对象的类别
- 链接预测，即预测两个或多个对象之间是否存在关联
- 基于链接的聚类，即将相似对象分组，其中相似性根据对象的链接确定，以及相关的协同过滤任务，即过滤与实体相关的信息（其中，如果已知某信息与相似实体相关，则认为该信息与该实体相关）
- 对象识别/实体解析/记录链接，即识别两个或多个独立数据库/数据集中的等价条目
- 社交网络建模

**需要进一步拓展的内容包括**：

- 关系马尔可夫网络与马尔可夫逻辑网络
- 关系贝叶斯网络与贝叶斯逻辑网络
- 概率关系模型(PRMs)与概率关系图
- 概率软逻辑与概率逻辑程序

### 关系马尔可夫网络与马尔可夫逻辑网络

#### [关系马尔可夫网络](http://www.robotics.stanford.edu/~koller/Papers/Taskar+al:SRL07.pdf)

框架基础：一个基于无向图的概率建模框架

关系马尔可夫网络可能解决的问题：

- **实现文档的关联分类**：考虑一个我们想要使用一组标签进行分类的超文本文档集合。最直观的方法是使用词袋模型。然而，这种方法完全忽略了超文本的丰富结构。一个文档会链接到其他文档，通常表明它们的主题相关；每个文档还具有内部结构。在分类文档集合时，这些线索是重要的，可能有助于我们实现更高的分类准确率。因此，我们不是单独分类每个文档，而是希望提供一种集体分类的形式，即在同时决定所有实体的类别标签，从而可以明确利用相关实体标签之间的相关性。
- **预测实体间关联关系**：一个挑战来自于预测哪些实体与哪些其他实体相关联，以及这些关系的类型。例如，在一个包含一组超链接大学网页的数据集中，我们不仅可能想要预测哪些页面属于教授，哪些属于学生，还可能想要预测哪些教授是哪些学生的导师。在某些情况下，关系的存在将通过页面之间的超链接来预测，我们只需决定该链接是否反映了导师-学生关系。在其他情况下，我们可能需要从间接证据中推断链接的存在，例如大量合著的论文。

##### 关系马尔可夫网络中的关系分类

**模式定义一组实体类型**：$E=\{ E_1,\cdots,E_n \}$，其具有如下三组属性

- 内容属性(content attributes)：$E.\bf{X}$
- 标签属性(label attributes)：$E.\bf{Y}$
- 引用属性(reference attributes)：$E.\bf{R}$，其包含唯一键属性$E.\bf{K}$用于识别每个实体；其他类型的实体指向单一类型实体$E=Range(E.\bf{R})$，其值在$Domain(E.\bf{K})$中

模式E的实例I指定了每个实体类型$E∈\Epsilon$的实体集合$I(E)$，示例$I$同样包括${I.\bf{X}},{I,\bf{Y}},{I.\bf{R}}$，这些属性的值用$I.x,I.y,I.r$表示；其中$I.r$被称为实例骨架(instantiation skeleton / instantiation graph)，指定实体(节点)集合及其引用属性(边)
> **案例**  
> 假设实体类型集合包括WebPage、Author，那么对应的实例化 I 中会有：I(WebPage)：如 {page1, page2, page3}，I(Author)：如 {alice, bob}，作者 alice 的属性，比如姓名、学科领域等，可设作 I.x(alice)、I.y(alice)、I.r(alice)（如 co-author 的链接关系）  
> 每个实体拥有属性包括网页 page1 的内容（X），标签（Y），及链接（R）：  
> - I.x(page1) = 一篇网页的单词内容  
> - I.y(page1) = 分类标签（如“新闻”）  
> - I.r(page1) = 链向的其它网页（如 {page2, page3}）  
{: .prompt-example }

同时，在概率关系模型中也需要把“链接”也当作模型里的一等公民，引入结构不确定性（Structural Uncertainty）以便做链接预测（Link Prediction）。假设连接$l$表示实体$\{ o_i,o_j \}$之间的连接，则$l.Exists$表示该链接存在，反之表示不存在；引入结构不确定性的模型可以预测链接是否应存在，并将这种结构作为条件用来提升属性预测准确率，其是建模的核心策略之一。

##### 关系马尔可夫网络的图结构和子图模板